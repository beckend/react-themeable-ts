{"version":3,"sources":["../src/hoc.tsx"],"names":[],"mappings":";;;;;;;;;AAAA,mCAAmC;AACnC;;GAEG;AACH,IAAY,KAAK,WAAM,OAAO,CAAC,CAAA;AAC/B,0BAGO,aAAa,CAAC,CAAA;AACrB,0BAA2C,aAAa,CAAC,CAAA;AACzD,4BAA6B,aAAa,CAAC,CAAA;AAE3C;;GAEG;AACH,IAAM,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACpC,iCAAiC;AACjC,IAAM,cAAc,GAAG,UAAC,KAAU,IAAK,OAAA,qBAAS,CAAC,KAAK,CAAC,EAAhB,CAAgB,CAAC;AACxD,IAAM,iCAAiC,GAAG;IACxC,MAAM,EAAE,CAAC;IACT,GAAG,EAAE,EAAE;CACR,CAAC;AAcF;;GAEG;AACH,IAAM,WAAW,GAAG;IAClB,QAAQ,EAAE,OAAO;IACjB,SAAS,EAAE,GAAG;CACf,CAAC;AAQF;;GAEG;AACH,wBAA8D,EAKnC;QALmC,4BAKnC,EAJzB,sBAAQ,EACR,wBAAS,EACT,8BAAY,EACZ,4BAAW;IAEX,IAAM,sBAAsB,GAAG,OAAO,CAAC,cAAc,EAAE,YAAY,IAAI,iCAAiC,CAAC,CAAC;IAE1G,IAAM,sBAAsB,GAAG,SAAS,IAAI,WAAW,CAAC,SAAS,CAAC;IAElE,2BAA2B;IAC3B,MAAM,CAAC,UAAC,gBAAkC;QACxC,qDAAqD;QACrD,2BAA2B;QAC3B,IAAM,eAAe,GAAQ,gBAAgB,CAAC;QAC9C,2BAA2B;QAC3B,IAAM,YAAY,GAAmB,CAAC,UAAC,KAAK,EAAE,UAAe;YAC3D,IAAM,iBAAiB,GAAG,sBAAsB,CAC9C,WAAW;;oBAEP,iBAAK,CAAC,UAAU,EAAE,WAAW,CAAC;;oBAE9B,KAAK,CAAC,QAAQ,IAAI,WAAW,CAAC,QAAQ,CAAC,CAC5C,CAAC;YACF,IAAM,cAAc,GAAG;gBACrB,GAAC,sBAAsB,CAAC,GAAE,iBAAiB;;aAC5C,CAAC;YAEF,MAAM,CAAC,CACL,oBAAC,eAAe,eAAK,cAAc,EAAM,KAAK,EAAI,CACnD,CAAC;;QACJ,CAAC,CAAC,CAAC;QAEH,YAAY,CAAC,YAAY,GAAG;YAC1B,GAAC,sCAA0B,CAAC,GAAE,KAAK,CAAC,SAAS,CAAC,MAAM;;SACrD,CAAC;QAEF,sDAAsD;QACtD,4CAA4C;QAC5C,MAAM,CAAC,YAAkC,CAAC;;IAC5C,CAAC,CAAC;AACJ,CAAC;AAzCe,sBAAc,iBAyC7B,CAAA","file":"hoc.js","sourcesContent":["/* tslint:disable: variable-name */\n/**\n * HOC react component\n */\nimport * as React from 'react';\nimport {\n  themeable,\n  IStaticFnReturn,\n} from './themeable';\nimport { THEME_PROVIDER_CONTEXT_KEY } from './constants';\nimport { get as opGet } from 'object-path';\n\n/**\n * Memoizee\n */\nconst memoize = require('memoizee');\n// Memoizeable themeable function\nconst getThemeableFn = (theme: any) => themeable(theme);\nconst getThemeableFnDefaultMemoizeeOpts = {\n  length: 1,\n  max: 10,\n};\n\nexport type TDecComponent<P> = React.SFC<P> | React.ComponentClass<P>;\nexport interface IThemeDecoratorArgs {\n  // The prop the HOC will use as argument for themeable\n  themeKey?: string;\n  // The prop name passed prop to DecoratedComponent as the returned themeable function\n  themeProp?: string;\n  // options passed to https://github.com/medikoo/memoizee\n  memoizeeOpts?: any;\n  // context if truthy will be used to navigate with \"object-path\" in context to find the theme object\n  // If not using default context path\n  contextPath?: string | string[];\n}\n/**\n * Defaults for the HOC\n */\nconst hocDefaults = {\n  themeKey: 'theme',\n  themeProp: 't',\n};\nexport interface IHOCDefaultNoThemeProps {\n  t: IStaticFnReturn;\n}\nexport interface IHOCDefaultProps extends IHOCDefaultNoThemeProps {\n  theme?: any;\n}\n\n/**\n * Main decorator\n */\nexport function themeDecorator<P extends IThemeDecoratorArgs>({\n  themeKey,\n  themeProp,\n  memoizeeOpts,\n  contextPath,\n}: IThemeDecoratorArgs = {}) {\n  const getThemeableFnMemoized = memoize(getThemeableFn, memoizeeOpts || getThemeableFnDefaultMemoizeeOpts);\n\n  const passedThemePropToChild = themeProp || hocDefaults.themeProp;\n\n  // tslint:disable-next-line\n  return (WrappedComponent: TDecComponent<P>) => {\n    // New typings gave bug to components, had to cast it\n    // tslint:disable-next-line\n    const TargetComponent: any = WrappedComponent;\n    // tslint:disable-next-line\n    const HOCThemeable: React.SFC<any> = ((props, contextArg: any) => {\n      const passedThemeableFn = getThemeableFnMemoized(\n        contextPath\n          ?\n            opGet(contextArg, contextPath)\n          :\n            props[themeKey || hocDefaults.themeKey]\n      );\n      const passedHOCProps = {\n        [passedThemePropToChild]: passedThemeableFn,\n      };\n\n      return (\n        <TargetComponent {...passedHOCProps} {...props} />\n      );\n    });\n\n    HOCThemeable.contextTypes = {\n      [THEME_PROVIDER_CONTEXT_KEY]: React.PropTypes.object,\n    };\n\n    // Seems like it's no possible to return this as a SFC\n    // without complaint when decorating a class\n    return HOCThemeable as React.SFC<P> | any;\n  };\n}\n"],"sourceRoot":"/source/"}